<div class="highlight"><pre><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

  <span class="nt">&lt;groupId&gt;</span>com.company<span class="nt">&lt;/groupId&gt;</span>
  <span class="c">&lt;!-- notice how we specify the packaging to be a war,</span>
<span class="c">          that way, maven knows where to copy the jar files --&gt;</span>
  <span class="nt">&lt;packaging&gt;</span>war<span class="nt">&lt;/packaging&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>railsApp<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;name&gt;</span>railsApp<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.company<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>java-legacy-app<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;finalName&gt;</span>railsApp<span class="nt">&lt;/finalName&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>exec-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="c">&lt;!-- This tasks only creates a basic structure expected by maven,</span>
<span class="c">                    so it can do its work --&gt;</span>
            <span class="nt">&lt;id&gt;</span>create-mock-web-descriptor<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>compile<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
              <span class="nt">&lt;executable&gt;</span>/bin/sh<span class="nt">&lt;/executable&gt;</span>
              <span class="nt">&lt;workingDirectory&gt;</span>.<span class="nt">&lt;/workingDirectory&gt;</span>
              <span class="nt">&lt;arguments&gt;</span>
                <span class="nt">&lt;argument&gt;</span>-c<span class="nt">&lt;/argument&gt;</span>
                <span class="nt">&lt;argument&gt;</span>
                    mkdir -p src/main/webapp/WEB-INF
                    touch    src/main/webapp/WEB-INF/web.xml
                <span class="nt">&lt;/argument&gt;</span>
              <span class="nt">&lt;/arguments&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="c">&lt;!-- Now in the package phase we copy the jar files</span>
<span class="c">                    that maven put into the fake web app to our rails&#39; lib folder --&gt;</span>
            <span class="nt">&lt;id&gt;</span>copy-needed-jars-into-lib<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
              <span class="nt">&lt;executable&gt;</span>/bin/sh<span class="nt">&lt;/executable&gt;</span>
              <span class="nt">&lt;workingDirectory&gt;</span>.<span class="nt">&lt;/workingDirectory&gt;</span>
              <span class="nt">&lt;arguments&gt;</span>
                <span class="nt">&lt;argument&gt;</span>-c<span class="nt">&lt;/argument&gt;</span>
                <span class="nt">&lt;argument&gt;</span>
                    rm -f lib/*.jar
                    cp target/railsApp/WEB-INF/lib/*.jar lib
                    rm -rf target/railsApp*
                    rm -rf src
                <span class="nt">&lt;/argument&gt;</span>
              <span class="nt">&lt;/arguments&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
           <span class="c">&lt;!-- Here we optionally create the final war file containing our rails app using warbler,</span>
<span class="c">                     doing a small cleanup of the files and folders maven created  --&gt;</span>
            <span class="nt">&lt;id&gt;</span>create-final-war<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
              <span class="nt">&lt;executable&gt;</span>/bin/sh<span class="nt">&lt;/executable&gt;</span>
              <span class="nt">&lt;workingDirectory&gt;</span>.<span class="nt">&lt;/workingDirectory&gt;</span>
              <span class="nt">&lt;arguments&gt;</span>
                <span class="nt">&lt;argument&gt;</span>-c<span class="nt">&lt;/argument&gt;</span>
                <span class="nt">&lt;argument&gt;</span>
                   rm -rf *.war tmp/war
                   jruby -S warble <span class="ni">&amp;amp;&amp;amp;</span> \
                   mv *.war target/railsApp.war
                <span class="nt">&lt;/argument&gt;</span>
              <span class="nt">&lt;/arguments&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>exec<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
     <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre>
</div>
