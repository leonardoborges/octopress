--- 
title: Procs, lambdas, blocks?! What's the difference?
excerpt: |-
  Do you know? 
  I didn't. And started to get annoyed by using these terms interchangeably and not really knowing the difference.
  
  There are a few. And they are subtle. I don't think most of us would eve...
date: 2009/07/22
updated_at: 2009/07/22
comments: true
layout: post
categories: 
- Ruby
---

<p>
Do you know? <br>I didn't. And started to get annoyed by using these terms interchangeably and not really knowing the difference.<br><br>There are a few. And they are subtle. I don't think most of us would ever have problems with it but it's the kind of information you'll be glad to know when having those weird behaviors in your code on a Friday at 6:01 pm, just before pushing to production. :)<br><br>I guess blocks are the most widely used term in the ruby community and there is little mistake on when to use it:<br><pre lang="ruby">[1,2,3].each do |x|<br>  puts x*2<br>end</pre><br>The code between <strong>do</strong> and <strong>end</strong> is a <strong><em>block</em></strong>.<br><br>What's important to keep in mind is that Procs behave like blocks whereas lambdas behave like methods. To understand what that means, I highlighted a couple of examples:<br><br><strong>- The return keyword</strong><br><br>I mentioned Procs behave just like blocks and as such, the return keyword abide to the same rules. This means, for instance, that the latest puts statement on the following code snippet, will never run:<br><pre lang="ruby">def my_proc(x)<br>  p = Proc.new { puts x*2; return }<br>  p.call<br>  puts "After calling proc" #This never gets called<br>end<br>my_proc(10)<br>>>20</pre><br>For blocks - and procs-, return means "return from the calling method", my_proc in this case. That's why you don't get to see the output of the puts statement.<br><br>On the other hand, in the lambda's example, we get the opposite behavior:<br><pre lang="ruby">def my_lambda(x)<br>  p = lambda { puts x*2; return }<br>  p.call<br>  puts "After calling proc" #This time, we reach this point<br>end<br>my_lambda(10)<br>>>20<br>>>After calling proc</pre><br>Here, return says "return from the enclosing iterator", which, in this case, just returns from the block and continnues the execution of the my_lambda method.<br><br><strong>- Argument assignment</strong><br><br>On to this second difference, procs and lambdas get more interesting when you can call them with arguments. And that's when another subtle difference between them comes in.<br><br>I'll start again with a proc:<br><br><pre lang="ruby"><br>  p = Proc.new { |x,y| puts x, y}<br>  p.call<br>  >>nil<br>  >>nil <br><br>  p.call(1)<br>  >>1<br>  >>nil<br><br>  p.call(1,2)<br>  >>1<br>  >>2<br><br>  p.call(1,2,3)<br>  >>1<br>  >>2<br><br>  p.call([1,2])<br>  >>1<br>  >>2<br></pre><br><br>See how procs are flexible? They basically won't complain if you do not provide parameters, provide extra parameters or even send an array as an argument where, as seen in the code above, it unpacks the array and assign its values to the correct variables.<br><br>As you're probably guessing, lambdas behave like methods and are much less flexible:<br><br><pre lang="ruby"><br>  l = lambda { |x,y| puts x, y}<br>  l.call<br>  >>ArgumentError: wrong number of arguments (0 for 2)<br><br>  l.call(1)<br>  >>ArgumentError: wrong number of arguments (1 for 2)<br><br>  l.call(1,2)<br>  >>1<br>  >>2<br><br>  l.call(1,2,3)<br>  >>ArgumentError: wrong number of arguments (3 for 2)<br><br>  l.call([1,2])<br>  >>ArgumentError: wrong number of arguments (1 for 2)<br></pre><br><br><br><p/><p/><br><strong>Ruby 1.9 tip</strong><br>Despite its name, Kernel.proc returns a lambda in Ruby 1.8. This has been fixed in Ruby 1.9. You actually get a Proc back.<br><br>- Reference<br><a href="http://www.amazon.com/gp/product/0596516177?ie=UTF8&tag=leonaborge-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0596516177">The Ruby Programming Language</a><img src="http://www.assoc-amazon.com/e/ir?t=leonaborge-20&l=as2&o=1&a=0596516177" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /> - A must have for any Ruby developer.<br> <br><script type="text/javascript" src="http://www.assoc-amazon.com/s/link-enhancer?tag=leonaborge-20&o=1"><br></script><br><noscript><br>    <img src="http://www.assoc-amazon.com/s/noscript?tag=leonaborge-20" alt="" /><br></noscript><br><br>
</p>

