--- 
title: Upgrading AppConstants to Rails 3
excerpt: Back in January I announced a small but useful plugin called AppConstants, that basically provides a central place where you can store environment specific constants. And since I started using Rails 3...
date: 2010/02/28
updated_at: 2010/02/28
comments: true
layout: post
categories: 
- Rails
- Ruby
---

<p>
Back in January I <a href="http://www.leonardoborges.com/writings/2010/01/23/my-take-on-rails-environment-specific-constants/" target="_blank">announced</a> a small but useful plugin called <a href="http://github.com/leonardoborges/app_constants">AppConstants</a>, that basically provides a central place where you can store environment specific constants. And since I started using Rails 3 in the past week, I thought I'd make it Rails 3 compatible.<br><br>The code is really simple and - as I expected - the upgrade process was quite straight forward.<br><br>I'm not gonna write a guide here on how to upgrade your plugins to Rails 3 - there is plenty about that around the web - but instead, just show the steps I went through to upgrade mine. Similar plugins might have a similar upgrade path.<br><br><strong>- Generators</strong><br><br>My plugin makes use of a simple generator that copies its default constants file and initializer to <em>Rails.root/config</em> and <em>Rails.root/config/initializers</em>, respectively. In Rails 2.x it was located under <em>Rails.root/vendor/plugins/app_constants/generators/app_constants</em> and it was defined like so:<br><br><script src="https://gist.github.com/790878.js?file=gistfile1.rb"></script><br><br>In Rails 3, the generators had to be moved to <em>Rails.root/vendor/plugins/app_constants/lib/generators</em>. Notice the root directory app_constants under generators has been removed as well. And the code was changed to this:<br><br><script src="https://gist.github.com/790879.js?file=gistfile1.rb"></script><br><br>We had three simple changes here:<br><br>- <em>The generator now extends from <em><strong>Rails::Generators::Base</strong></em></em>: This class uses the Thor infrastructure to handle generators. - more info <a href="http://blog.plataformatec.com.br/2009/07/creating-your-own-generators-with-thor/" target="_blank">here</a>.<br><br>- <em>I had to implement the <strong>source_root</strong> class method</em>, which basically tells your generator where to find your template files.<br><br>- <em>The <em><strong>manifest</strong></em> method is now called <em><strong>copy_config_files</strong></em> - or <strong><em>anything</em></strong></em> you want. <br><br>The way this works is that, once you invoke the generator, Thor will sequentially call all instance methods in your generator class - or the only instance method in the example above. If your generator does a lot, it will allow for a better organization of your tasks.<br><br>And that's it! I did change a couple of other things but that had to be changed anyway and are not related to the migration.<br><br>For Rails 2.3.x users, you'll find a 2.3.x branch on github that should work for you.<br><br>Cheers
</p>

